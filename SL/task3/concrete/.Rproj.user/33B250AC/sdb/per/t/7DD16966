{
    "contents" : "---\ntitle: \"hw3_1\"\noutput: html_document\n---\n\n\n```{r}\nlibrary(lattice)\nlibrary(MASS)\nlibrary(e1071)\nlibrary(latticeExtra)\nlibrary(corrplot)\n\nconcr.data <- read.csv(\"data/Concrete_Data.csv\", comment.char = \"#\")\npanel <- function(...) {  \n  panel.xyplot(...)\n  panel.loess(...)\n}\n\n\n```\n\n```{r}\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$Superplasticizer, panel=panel)\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$Cement, panel=panel)\n\n```\n\nВидна отличная линейная зависимость прочности от цемента, а также от Superplasticizer(далее Суперпластик). Ну это и понятно, т.к. они являются главными скрепляющими и упрочняющими ингредиентами\n\n```{r}\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$Water, panel=panel)\n\n```\n\nС водой происходит не очень понятный скачек вверх после систематического опускания. Вообще говоря мы достигаем минимума при самой большой плотности точек, а далее точек совсем мало, и возможно, дальшейшие результаты можно сбросить на недостаточное количество данных. Попробуем его позже разобрать подробнее.\n\n```{r}\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$CoarseAggregate, panel=panel)\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$FineAggregate, panel=panel)\n```\n\nАггрегаты очень похожы, и переваливая за 810 практически не влияют на прочность, скорее всего они будут малозначимыми\n\n\n```{r}\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$Age, panel=panel)\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$BlastFurnaceSlag, panel=panel)\nxyplot(concr.data$ConcreteCompressiveStrength ~ concr.data$FlyAsh, panel=panel)\n```\n\nВозраст выглядит совсем неоднородным, видимо его нужно будет сделать фактором\n\n \n```{r}\n\nmodel1 <- lm(ConcreteCompressiveStrength ~ (.), data=concr.data)\nsummary(model1)\n```\n\nПосмотрим на корреляцию:\n\n```{r}\ncorrplot(cor(concr.data))\nxyplot(concr.data$Water ~ concr.data$Superplasticizer, panel=panel)\n```\n\nПостроим модель, откинув не сильно значимые признаки агрегаторов, а также добавим\nWater:Superplasticizer, т.к. между ними явно есть зависимость\n\n```{r}\n\n\nmodel1 <- lm(ConcreteCompressiveStrength ~ Cement + Water + BlastFurnaceSlag + FlyAsh + Superplasticizer + Age + Water:Superplasticizer, data=concr.data)\nsummary(model1)\n```\n\nНемного лучше, но еще не очень.\n\nПосмотрим на графики распределений предикторов:\n\n```{r}\nmarginal.plot(concr.data)\n```\n\nAge выглядит совсем плохо, попробуем прологарифмировать\n\n```{r}\nmarginal.plot(log(concr.data$Age))\nxyplot(concr.data$ConcreteCompressiveStrength ~ log(concr.data$Age), panel=panel)\n\n```\n\nСтало лучше\nПосмотрим модель\n\n```{r}\nmodel2 <- lm(ConcreteCompressiveStrength ~ Cement + Water + BlastFurnaceSlag + FlyAsh + Superplasticizer + log(Age) + Water:Superplasticizer, data=concr.data)\nsummary(model2)\n```\n\nНамного лучше, но Мне все еще не нравится изломанность графика воды \nПоэтому можно попробовать добавить фактор  для воды:\n\n```{r}\nconcr.data$Water.factor <- concr.data$Water < 225\nmodel3 <-lm(ConcreteCompressiveStrength ~ Cement + Water.factor:Water + BlastFurnaceSlag + FlyAsh + Superplasticizer + log(Age) + Water:Superplasticizer, data=concr.data)\nsummary(model3)\n```\n\nНемного поперебирав значение порога получаем высоко значимый признак Water.factorTrue:Water, который говорит как влияет количство воды до 225 на прочность\n\nПопробуем также и возраст сделать фактором:\n\n```{r}\nconcr.data$Age.factor <- concr.data$Age < 150\nmodel4 <-lm(ConcreteCompressiveStrength ~ Cement + Water.factor:Water + BlastFurnaceSlag + FlyAsh + Superplasticizer + Age.factor:log(Age) + Water:Superplasticizer, data=concr.data)\nsummary(model4)\n```\n\nИ это тоже улучшило модель\n\nПроверим модели\n\n```{r}\nanova(model1, model2, model3, model4)\n```\nПоследняя модель самая лучшая\n\n```{r}\nxyplot(residuals(model1) ~ fitted(model1), panel=panel)\nxyplot(residuals(model2) ~ fitted(model2), panel=panel)\nxyplot(residuals(model3) ~ fitted(model3), panel=panel)\nxyplot(residuals(model4) ~ fitted(model4), panel=panel)\n```\n\nБолее менее линейно\n\n```{r}\n\ncv <- function(model) { \n  tune(lm, model$call$formula, data = concr.data, tunecontrol = tune.control(sampling = \"cross\")) \n}\ncv(model1)\ncv(model2)\ncv(model3)\ncv(model4)\n```\n\nНа убывание, однако итоговая ошибка все-равно очень велика относительно диапозона прочности\n\n",
    "created" : 1420757596417.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "928703574",
    "id" : "7DD16966",
    "lastKnownWriteTime" : 1420590970,
    "path" : "~/Spbau/SL/antoha/Stat-SpbAU/hw3/hw3_1.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}